@startuml
' Диаграмма бизнес-процессов для симулятора экономических моделей

skinparam defaultFontName "Times New Roman"
skinparam defaultFontSize 12

start
:Пользователь запускает клиентское приложение;

partition Аутентификация {
    :Ввод данных для входа или регистрации;
    if (Есть аккаунт?) then (да)
        :Отправка запроса на вход на сервер;
        :Получение токенов доступа;
    else
        :Отправка регистрационных данных на сервер;
        :Получение кода подтверждения по email;
        :Ввод и подтверждение кода;
    endif
}

partition Управление_документами {
    :Просмотр списка документов;
    if (Загрузить новый?) then (да)
        :Загрузка PDF на сервер → сохранение в MinIO;
    endif
    if (Скачать/удалить?) then (да)
        :Запрос файла на сервер;
    endif
    ' "Удлиняем" переход к следующему блоку
    -[hidden]->; 
    -[hidden]->; 
}

partition Работа_с_моделями {
    :Выбор экономической модели;
    :Загрузка пользовательских параметров с сервера;
    if (Извлечь из документа?) then (да)
        :Отправка документа и информации о модели в LLM-сервис;
        :Получение извлечённых параметров;
    endif
    :Запуск расчёта модели на сервере;
    :Сохранение результатов в базе данных;
}

partition LLM_Чат {
    if (Требуется пояснение?) then (да)
        :Отправка сообщения с данными модели в LLM;
        :Получение ответа ассистента;
    endif
}

partition Формирование_отчёта {
    :Создание отчёта с параметрами, графиками и сообщениями LLM;
    :Сервер формирует PDF и сохраняет в MinIO;
    :Пользователь скачивает или просматривает отчёт;
}

stop
@enduml
